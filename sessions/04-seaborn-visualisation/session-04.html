<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-165dbca8e4ef789eecedfc9f9a8a2b1c.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.22">

  <meta name="author" content="Specialist Analytics Team (SAT)">
  <title>Visualisation with Seaborn</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #000000; background-color: #ffffff; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #000000; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; } /* BuiltIn */
    code span.cf { color: #000000; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #644a9b; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #000000; font-weight: bold; } /* Keyword */
    code span.op { color: #000000; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #ff5500; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-c34f77340c5b9e6f1db133eece9f3dab.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/verticator/verticator.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../../images/scw_logo.jpg" data-background-opacity="1" data-background-position="right 5% bottom 5%" data-background-size="22%" class="quarto-title-block center">
  <h1 class="title">Visualisation with Seaborn</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Specialist Analytics Team (SAT) 
</div>
</div>
</div>

</section>
<section class="slide level2">

<p>Python has a rich ecosystem of libraries for data visualisation, each with different strengths. Some popular options include matplotlib for fine control over plots, plotly for interactive visualisations, and bokeh for web-ready dashboards. In this session, we’ll be using seaborn. It’s built on top of matplotlib but offers a simpler, high-level interface and nice looking default styles — it’s therefore a good choice when you who want to quickly create clear and informative plots without needing to tweak every detail.</p>
<figure>
<img src="../../images/python_visual_libraries.png" alt="Python (and R) visualisation libraries.">
<figcaption aria-hidden="true">
Python (and R) visualisation libraries.
</figcaption>
</figure>
<p>We are using <a href="https://www.kaggle.com/datasets/jsphyg/weather-dataset-rattle-package">Australian weather data</a>, taken from <a href="https://kaggle.com">Kaggle</a>. This dataset is used to build machine learning models that predict whether it will rain tomorrow, using data about the weather every day from 2007 to 2017. To download the data, click <a href="data/weatherAUS.csv">here</a>.</p>
<p>One final note before we get started - This page is a combination of text and python code. We’ve tried to explain clearly what we’re about to do before we do it, but do also note the <code># comments</code> within the python code cells themselves that occasionally explain a specific line of code in more detail.</p>
</section>
<section id="initial-setup" class="slide level2">
<h2>Initial setup</h2>
<p>We’re going to import some python packages. Remember that the <code>plt</code>, <code>np</code>, <code>sns</code> aliases are just for convenience - we could omit this completely or use different aliases if we prefer.</p>
<blockquote>
<p><strong>Aside - why <code>sns</code>?</strong></p>
<p>Seaborn being imported as <code>sns</code> is an odd convention (they are the initials of the fictional character the package was named for) that will make it easier to read or copy/paste online examples.</p>
</blockquote>
<div id="setup" class="cell columns column-output-location" data-execution_count="19">
<div class="column">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="co"># install necessary packages</span></span>
<span id="cb1-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="co"># suppress some annoying warnings</span></span>
<span id="cb1-8"><a></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>) </span>
<span id="cb1-10"><a></a></span>
<span id="cb1-11"><a></a>sns.set_theme(style<span class="op">=</span><span class="st">'darkgrid'</span>) <span class="co"># https://seaborn.pydata.org/generated/seaborn.set_theme.html</span></span>
<span id="cb1-12"><a></a>sns.set_context(<span class="st">"notebook"</span>) <span class="co"># set an overall scale. Notebook is the default. In increasing size: paper, notebook, talk, poster.</span></span>
<span id="cb1-13"><a></a>plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'Calibri'</span>,<span class="st">'Segoe UI'</span>,<span class="st">'Arial'</span>] <span class="co"># use a nicer font in matplotlib (if available)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
<p>As before, we need to import our dataset. We’re importing the <code>csv</code> file into an initial dataframe called <code>df</code> to start with.</p>
<div id="import-data" class="cell columns column-output-location" data-execution_count="21">
<div class="column">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="co"># import the dataset</span></span>
<span id="cb2-2"><a></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/weatherAUS.csv'</span>)</span>
<span id="cb2-3"><a></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="21">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">MinTemp</th>
<th data-quarto-table-cell-role="th">MaxTemp</th>
<th data-quarto-table-cell-role="th">Rainfall</th>
<th data-quarto-table-cell-role="th">Evaporation</th>
<th data-quarto-table-cell-role="th">Sunshine</th>
<th data-quarto-table-cell-role="th">WindGustDir</th>
<th data-quarto-table-cell-role="th">WindGustSpeed</th>
<th data-quarto-table-cell-role="th">WindDir9am</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Humidity9am</th>
<th data-quarto-table-cell-role="th">Humidity3pm</th>
<th data-quarto-table-cell-role="th">Pressure9am</th>
<th data-quarto-table-cell-role="th">Pressure3pm</th>
<th data-quarto-table-cell-role="th">Cloud9am</th>
<th data-quarto-table-cell-role="th">Cloud3pm</th>
<th data-quarto-table-cell-role="th">Temp9am</th>
<th data-quarto-table-cell-role="th">Temp3pm</th>
<th data-quarto-table-cell-role="th">RainToday</th>
<th data-quarto-table-cell-role="th">RainTomorrow</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008-12-01</td>
<td>Albury</td>
<td>13.4</td>
<td>22.9</td>
<td>0.6</td>
<td>NaN</td>
<td>NaN</td>
<td>W</td>
<td>44.0</td>
<td>W</td>
<td>...</td>
<td>71.0</td>
<td>22.0</td>
<td>1007.7</td>
<td>1007.1</td>
<td>8.0</td>
<td>NaN</td>
<td>16.9</td>
<td>21.8</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2008-12-02</td>
<td>Albury</td>
<td>7.4</td>
<td>25.1</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>WNW</td>
<td>44.0</td>
<td>NNW</td>
<td>...</td>
<td>44.0</td>
<td>25.0</td>
<td>1010.6</td>
<td>1007.8</td>
<td>NaN</td>
<td>NaN</td>
<td>17.2</td>
<td>24.3</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2008-12-03</td>
<td>Albury</td>
<td>12.9</td>
<td>25.7</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>WSW</td>
<td>46.0</td>
<td>W</td>
<td>...</td>
<td>38.0</td>
<td>30.0</td>
<td>1007.6</td>
<td>1008.7</td>
<td>NaN</td>
<td>2.0</td>
<td>21.0</td>
<td>23.2</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2008-12-04</td>
<td>Albury</td>
<td>9.2</td>
<td>28.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NE</td>
<td>24.0</td>
<td>SE</td>
<td>...</td>
<td>45.0</td>
<td>16.0</td>
<td>1017.6</td>
<td>1012.8</td>
<td>NaN</td>
<td>NaN</td>
<td>18.1</td>
<td>26.5</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2008-12-05</td>
<td>Albury</td>
<td>17.5</td>
<td>32.3</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>W</td>
<td>41.0</td>
<td>ENE</td>
<td>...</td>
<td>82.0</td>
<td>33.0</td>
<td>1010.8</td>
<td>1006.0</td>
<td>7.0</td>
<td>8.0</td>
<td>17.8</td>
<td>29.7</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>

<p>5 rows × 23 columns</p>
</div>
</div>
</div></div>
</section>
<section id="data-manipulation" class="slide level2">
<h2>Data manipulation</h2>
<section id="column-conversions" class="level3">
<h3>Column conversions</h3>
<p>Before we start actually generating some visuals, we need to make sure our Date column contains proper datetimes. We’re also going to drop the years with partial data so that our dataset only has full years. Finally we’re going to change the RainTomorrow field to contain a 0 or a 1 rather than yes/no.</p>
<div id="8052c3f0" class="cell columns column-output-location" data-execution_count="22">
<div class="column">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="co"># convert date column to datetime</span></span>
<span id="cb3-2"><a></a>df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Date'</span>])</span>
<span id="cb3-3"><a></a></span>
<span id="cb3-4"><a></a><span class="co"># create a column that just contains the year</span></span>
<span id="cb3-5"><a></a>df[<span class="st">'Year'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.year</span>
<span id="cb3-6"><a></a></span>
<span id="cb3-7"><a></a><span class="co"># drop the partial years (2007,2017)</span></span>
<span id="cb3-8"><a></a>df <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'Year'</span>].isin([<span class="dv">2007</span>,<span class="dv">2017</span>])]</span>
<span id="cb3-9"><a></a></span>
<span id="cb3-10"><a></a><span class="co"># convert 'RainTomorrow' to a numeric variable, where 'Yes' = 1 and 'No' = 0.</span></span>
<span id="cb3-11"><a></a>df[<span class="st">'RainToday'</span>]<span class="op">=</span>df[<span class="st">'RainToday'</span>].replace({<span class="st">'Yes'</span>: <span class="dv">1</span>, <span class="st">'No'</span>: <span class="dv">0</span>, <span class="st">'NA'</span>:<span class="dv">0</span>}).fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb3-12"><a></a>df[<span class="st">'RainTomorrow'</span>]<span class="op">=</span>df[<span class="st">'RainTomorrow'</span>].<span class="bu">map</span>({<span class="st">'Yes'</span>: <span class="dv">1</span>, <span class="st">'No'</span>: <span class="dv">0</span>,<span class="st">'NA'</span>: <span class="dv">0</span>}).fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)<span class="op">;</span> </span>
<span id="cb3-13"><a></a></span>
<span id="cb3-14"><a></a><span class="co"># little tip: the semicolon suppresses textual output when we don't want it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
</section>
<section id="sort-order-and-other-helper-tables" class="level3">
<h3>Sort order and other helper tables</h3>
<p>We need a month order for our “mmm” months - there is probably an official way of doing this…</p>
<div id="fca9a9b5" class="cell columns column-output-location" data-execution_count="25">
<div class="column">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>month_order <span class="op">=</span> [<span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span>, <span class="st">'Apr'</span>, <span class="st">'May'</span>, <span class="st">'Jun'</span>, <span class="st">'Jul'</span>, <span class="st">'Aug'</span>, <span class="st">'Sep'</span>, <span class="st">'Oct'</span>, <span class="st">'Nov'</span>, <span class="st">'Dec'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
<p>We also need a sort order for our city names to use as a column order for some of our charts later. We’ll just arrange them alphabetically.</p>
<div id="c6bf3a25" class="cell columns column-output-location" data-execution_count="26">
<div class="column">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a>colOrder_top5Cities<span class="op">=</span>[<span class="st">'Adelaide'</span>,<span class="st">'Brisbane'</span>,<span class="st">'Melbourne'</span>,<span class="st">'Perth'</span>,<span class="st">'Sydney'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
<p>To enhance a chart we’re going to build later, we’re going to dynamically calculate some text describing our data range.</p>
<div id="1d27a840" class="cell columns column-output-location" data-execution_count="27">
<div class="column">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="co"># Calculate the date range dynamically; we're going to use this later...</span></span>
<span id="cb6-2"><a></a>date_min <span class="op">=</span> df[<span class="st">'Date'</span>].<span class="bu">min</span>().strftime(<span class="st">'%Y'</span>)</span>
<span id="cb6-3"><a></a>date_max <span class="op">=</span> df[<span class="st">'Date'</span>].<span class="bu">max</span>().strftime(<span class="st">'%Y'</span>)</span>
<span id="cb6-4"><a></a>date_range <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>date_min<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>date_max<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb6-5"><a></a></span>
<span id="cb6-6"><a></a><span class="bu">print</span>(date_range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>2008 - 2016</code></pre>
</div>
</div></div>
</section>
<section id="pivoting-and-grouping" class="level3">
<h3>Pivoting and grouping</h3>
<p>Next, we’re going to create some helper dataframes by filtering, grouping and pivoting the data. These will be used for different types of visuals later. Of course, we could have just created these groupings and pivots inline when we do the actual visualisation, but we’re doing it this way because:</p>
<ol type="1">
<li>It’s easier to follow</li>
<li>It’s tidier (and probably faster) to create these dataframes once as we’re going to be using them multiple times.</li>
</ol>
<div id="4bfdf9af" class="cell columns column-output-location" data-execution_count="29">
<div class="column">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="co"># build a month column</span></span>
<span id="cb8-2"><a></a>df[<span class="st">'Month'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.strftime(<span class="st">'%b'</span>) <span class="co"># Add a column that just contains the month in mmm format</span></span>
<span id="cb8-3"><a></a>df[<span class="st">'Month'</span>] <span class="op">=</span> pd.Categorical(df[<span class="st">'Month'</span>], categories<span class="op">=</span>month_order, ordered<span class="op">=</span><span class="va">True</span>) <span class="co"># Make it categorical using our custom order so that it appears in the right order</span></span>
<span id="cb8-4"><a></a></span>
<span id="cb8-5"><a></a><span class="co"># we're going to filter to top 5 cities from now on</span></span>
<span id="cb8-6"><a></a>df_top5Cities <span class="op">=</span> df[df[<span class="st">'Location'</span>].isin([<span class="st">'Perth'</span>,<span class="st">'Adelaide'</span>,<span class="st">'Sydney'</span>,<span class="st">'Melbourne'</span>,<span class="st">'Brisbane'</span>])]</span>
<span id="cb8-7"><a></a></span>
<span id="cb8-8"><a></a><span class="co"># a dataframe with the number of rainy days per year and month, and location</span></span>
<span id="cb8-9"><a></a>df_top5Cities_rainyDays <span class="op">=</span> df_top5Cities.groupby([<span class="st">'Location'</span>,<span class="st">'Year'</span>, <span class="st">'Month'</span>])[<span class="st">'RainToday'</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb8-10"><a></a></span>
<span id="cb8-11"><a></a><span class="co"># finally, we're going to create some grouped and pivoted dataframes. Picture these as PivotTables in Excel.</span></span>
<span id="cb8-12"><a></a>df_top5Cities_Rainfall_grouped <span class="op">=</span> df_top5Cities.groupby([<span class="st">'Location'</span>, <span class="st">'Month'</span>])[<span class="st">'Rainfall'</span>].mean().reset_index()</span>
<span id="cb8-13"><a></a>df_top5Cities_Rainfall_pivoted <span class="op">=</span> df_top5Cities_Rainfall_grouped.pivot(index<span class="op">=</span><span class="st">"Location"</span>,columns<span class="op">=</span><span class="st">"Month"</span>, values<span class="op">=</span><span class="st">"Rainfall"</span>)</span>
<span id="cb8-14"><a></a>df_top5Cities_monthly_rainyDays_pivoted <span class="op">=</span> df_top5Cities.groupby([<span class="st">'Location'</span>, <span class="st">'Month'</span>,<span class="st">'Year'</span>])[<span class="st">'RainToday'</span>].<span class="bu">sum</span>().reset_index().groupby([<span class="st">'Location'</span>,<span class="st">'Month'</span>])[<span class="st">'RainToday'</span>].mean().reset_index().pivot(index<span class="op">=</span><span class="st">"Location"</span>,columns<span class="op">=</span><span class="st">"Month"</span>, values<span class="op">=</span><span class="st">"RainToday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
<p>Let’s use <code>head()</code> to make sure we understand what each grouped/pivoted DF is for.</p>
<div id="7704d404" class="cell columns column-output-location" data-execution_count="30">
<div class="column">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>df_top5Cities_Rainfall_grouped.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Rainfall</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Adelaide</td>
<td>Jan</td>
<td>0.672199</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Adelaide</td>
<td>Feb</td>
<td>0.973604</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div id="e6cbc37b" class="cell columns column-output-location" data-execution_count="31">
<div class="column">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a>df_top5Cities_Rainfall_pivoted.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="31">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Jan</th>
<th data-quarto-table-cell-role="th">Feb</th>
<th data-quarto-table-cell-role="th">Mar</th>
<th data-quarto-table-cell-role="th">Apr</th>
<th data-quarto-table-cell-role="th">May</th>
<th data-quarto-table-cell-role="th">Jun</th>
<th data-quarto-table-cell-role="th">Jul</th>
<th data-quarto-table-cell-role="th">Aug</th>
<th data-quarto-table-cell-role="th">Sep</th>
<th data-quarto-table-cell-role="th">Oct</th>
<th data-quarto-table-cell-role="th">Nov</th>
<th data-quarto-table-cell-role="th">Dec</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Adelaide</td>
<td>0.672199</td>
<td>0.973604</td>
<td>1.171667</td>
<td>1.461165</td>
<td>2.293860</td>
<td>2.447009</td>
<td>2.873606</td>
<td>2.399237</td>
<td>1.809125</td>
<td>0.906273</td>
<td>0.730827</td>
<td>1.192500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Brisbane</td>
<td>6.415574</td>
<td>5.325389</td>
<td>4.442276</td>
<td>3.165385</td>
<td>3.126446</td>
<td>2.516318</td>
<td>1.000000</td>
<td>1.273381</td>
<td>1.314498</td>
<td>2.419424</td>
<td>3.347761</td>
<td>4.551613</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div id="8897ced8" class="cell columns column-output-location" data-execution_count="32">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>df_top5Cities_monthly_rainyDays_pivoted.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="32">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Jan</th>
<th data-quarto-table-cell-role="th">Feb</th>
<th data-quarto-table-cell-role="th">Mar</th>
<th data-quarto-table-cell-role="th">Apr</th>
<th data-quarto-table-cell-role="th">May</th>
<th data-quarto-table-cell-role="th">Jun</th>
<th data-quarto-table-cell-role="th">Jul</th>
<th data-quarto-table-cell-role="th">Aug</th>
<th data-quarto-table-cell-role="th">Sep</th>
<th data-quarto-table-cell-role="th">Oct</th>
<th data-quarto-table-cell-role="th">Nov</th>
<th data-quarto-table-cell-role="th">Dec</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Adelaide</td>
<td>2.555556</td>
<td>1.555556</td>
<td>3.666667</td>
<td>4.000000</td>
<td>7.666667</td>
<td>8.555556</td>
<td>13.444444</td>
<td>11.444444</td>
<td>7.888889</td>
<td>4.222222</td>
<td>4.000000</td>
<td>4.555556</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Brisbane</td>
<td>8.000000</td>
<td>7.111111</td>
<td>10.000000</td>
<td>5.333333</td>
<td>5.555556</td>
<td>6.222222</td>
<td>4.111111</td>
<td>3.555556</td>
<td>4.111111</td>
<td>5.888889</td>
<td>6.888889</td>
<td>8.777778</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<blockquote>
<p><strong>Aside: why <code>df[df[...</code>?</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>df_top5Cities <span class="op">=</span> df[df[<span class="st">'Location'</span>].isin([<span class="st">'Perth'</span>,<span class="st">'Adelaide'</span>,<span class="st">'Sydney'</span>,<span class="st">'Melbourne'</span>,<span class="st">'Brisbane'</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The first (outer) <code>df[</code> tells pandas that we want to select a subset of rows based on some condition.</li>
<li>The second (inner) <code>df[</code> is going to tell pandas this condition. In this case, we’re using <code>isin</code> to return a dataframe that contains a series of <code>True</code> and <code>False</code> rows corresponding to whether the rows in our original dataframe had the <code>Location</code> column as one of our 5 cities.</li>
<li>The final dataframe is then a filtered copy where the inner condition is <code>True</code>.</li>
</ul>
<p>Yes, there are other ways of doing this! For example by using <code>.query()</code> to specify our conditions.</p>
</blockquote>
</section>
</section>
<section id="doing-some-actual-plotting" class="slide level2">
<h2>Doing some actual plotting</h2>
<p>The Seaborn home page has a very good <a href="https://seaborn.pydata.org/tutorial/introduction.html">introductory tutorial</a>, <a href="https://seaborn.pydata.org/api.html">reference documentation</a>, and a <a href="https://seaborn.pydata.org/examples/index.html">nice collection of examples</a>. You should familiarise yourself with the documentation; it’ll pay off massively if you actually grasp what each function and argument is for, rather than just copy/pasting examples and tweaking them until they work (without really understanding what they’re doing).</p>
<section id="a-basic-one-line-line-chart" class="level3">
<h3>A basic one-line line chart</h3>
<div id="f88c3bb9" class="cell columns column-output-location" data-execution_count="35">
<div class="column">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>sns.lineplot(</span>
<span id="cb13-2"><a></a>  data<span class="op">=</span>df_top5Cities_Rainfall_pivoted.T <span class="co">#.T gives the transpose (flips rows and columns)</span></span>
<span id="cb13-3"><a></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-12-output-1.png"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="just-a-little-bit-of-customisation---a-bar-chart" class="level3">
<h3>Just a little bit of customisation - a bar chart</h3>
<p><a href="https://seaborn.pydata.org/generated/seaborn.barplot.html" class="uri">https://seaborn.pydata.org/generated/seaborn.barplot.html</a></p>
<div id="b26c810f" class="cell columns column-output-location" data-execution_count="42">
<div class="column">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>our_barplot <span class="op">=</span> sns.barplot(</span>
<span id="cb14-2"><a></a>  data<span class="op">=</span>df_top5Cities_Rainfall_grouped </span>
<span id="cb14-3"><a></a>  ,x<span class="op">=</span><span class="st">"Month"</span></span>
<span id="cb14-4"><a></a>  ,y<span class="op">=</span><span class="st">"Rainfall"</span></span>
<span id="cb14-5"><a></a>  ,hue<span class="op">=</span><span class="st">"Location"</span> <span class="co"># read "hue" as "series"</span></span>
<span id="cb14-6"><a></a>  ,palette<span class="op">=</span><span class="st">"tab10"</span> <span class="co"># https://matplotlib.org/stable/users/explain/colors/colormaps.html</span></span>
<span id="cb14-7"><a></a>  )</span>
<span id="cb14-8"><a></a></span>
<span id="cb14-9"><a></a>our_barplot.<span class="bu">set</span>(title<span class="op">=</span><span class="st">'Average daily rainfall by month and city'</span>,ylim<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">8</span>))</span>
<span id="cb14-10"><a></a></span>
<span id="cb14-11"><a></a>sns.move_legend(our_barplot,<span class="st">"upper left"</span>, title<span class="op">=</span><span class="va">None</span>, ncol<span class="op">=</span><span class="dv">4</span>) <span class="co"># https://seaborn.pydata.org/generated/seaborn.move_legend.html</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-13-output-1.png"></p>
</figure>
</div>
</div>
</div></div>
<blockquote>
<p><strong>Aside - why did we need to set the title <em>after</em> the <code>sns.barplot</code> call?</strong></p>
<p>The <code>barplot</code> function provided by Seaborn doesn’t actually allow setting of a title - it just generates a plot (including its axes) and returns this as a matplotlib <code>Axes</code> object (recall we mentioned earlier that Seaborn is a layer on top of the matplotlib library). By using the <code>.set(...)</code> method on our barplot object, we can <em>modify</em> this returned object to give it a title. We also could have used this to customise our axis labels (the defaults are fine here), set axis limits, or things like tick labels.</p>
</blockquote>
</section>
<section id="heatmaps" class="level3">
<h3>Heatmaps</h3>
<p>The Seaborn <code>heatmap</code> function will easily let us create a two-dimensional heatmap visual with a specific colour theme and custom number formatting.</p>
<div id="5fe547f5" class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="co"># We need to use some matplotlib code to set our output size, add a title, and capitalise our x-axis label</span></span>
<span id="cb15-2"><a></a>f,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>)) <span class="co"># matplotlib subplots are a common way of setting a figure layout</span></span>
<span id="cb15-3"><a></a>ax.set_title(<span class="ss">f"Average daily rainfall (/mm) each month (</span><span class="sc">{</span>date_range<span class="sc">}</span><span class="ss">) for Australia's top 5 cities"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>, pad<span class="op">=</span><span class="dv">10</span>) <span class="co"># using our previously set date_range variable</span></span>
<span id="cb15-4"><a></a></span>
<span id="cb15-5"><a></a>sns.heatmap(df_top5Cities_Rainfall_pivoted <span class="co"># Heatmap expects rectangular (pivot-like) data</span></span>
<span id="cb15-6"><a></a>            ,annot<span class="op">=</span><span class="va">True</span> <span class="co"># Put numbers inside the cells</span></span>
<span id="cb15-7"><a></a>            ,fmt<span class="op">=</span><span class="st">".1f"</span> <span class="co"># Make the numbers have 1 decimal place</span></span>
<span id="cb15-8"><a></a>            ,square<span class="op">=</span><span class="va">True</span> <span class="co"># Square vs rectangular cells</span></span>
<span id="cb15-9"><a></a>            ,cbar<span class="op">=</span><span class="va">False</span> <span class="co"># Get rid of the colourbar legend on the side</span></span>
<span id="cb15-10"><a></a>            ,cmap<span class="op">=</span><span class="st">"Blues"</span> <span class="co"># Seems appropriate for rainfall. Colourmaps reference: https://matplotlib.org/stable/users/explain/colors/colormaps.html </span></span>
<span id="cb15-11"><a></a>            ,ax<span class="op">=</span>ax <span class="co"># Tell it to use the matplotlib axes we created earlier</span></span>
<span id="cb15-12"><a></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-14-output-1.png"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="another-heatmap-with-some-further-tweaks" class="level3">
<h3>Another heatmap with some further tweaks</h3>
<p>We can make our heatmap look just a little better by apply some tweaks to the subplots object.</p>
<div id="0247dee1" class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a><span class="co"># Again setting up matplotlib subplots so that we can make some changes later</span></span>
<span id="cb16-2"><a></a>f,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>)) </span>
<span id="cb16-3"><a></a></span>
<span id="cb16-4"><a></a>sns.heatmap(df_top5Cities_monthly_rainyDays_pivoted <span class="co"># Heatmap expects rectangular (pivot-like) data</span></span>
<span id="cb16-5"><a></a>            ,annot<span class="op">=</span><span class="va">True</span> <span class="co"># Put numbers inside the cells</span></span>
<span id="cb16-6"><a></a>            ,fmt<span class="op">=</span><span class="st">".0f"</span> <span class="co"># Force the number format</span></span>
<span id="cb16-7"><a></a>            ,square<span class="op">=</span><span class="va">True</span> <span class="co"># Square vs rectangular cells</span></span>
<span id="cb16-8"><a></a>            ,cbar<span class="op">=</span><span class="va">False</span> <span class="co"># Get rid of the colourbar legend on</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-15-output-1.png"></p>
</figure>
</div>
</div>
</div></div>
<div id="a591a0b9" class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a> the side</span>
<span id="cb17-2"><a></a>            ,cmap<span class="op">=</span><span class="st">"crest"</span> <span class="co"># Colourmaps reference: https://matplotlib.org/stable/users/explain/colors/colormaps.html </span></span>
<span id="cb17-3"><a></a>            ,ax<span class="op">=</span>ax <span class="co"># Tell it to use the matplotlib axes we created earlier</span></span>
<span id="cb17-4"><a></a>           )</span>
<span id="cb17-5"><a></a></span>
<span id="cb17-6"><a></a><span class="co"># We need to use some matplotlib code to set our output size, add a title, and capitalise our x-axis label</span></span>
<span id="cb17-7"><a></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">11</span>, rotation<span class="op">=</span><span class="dv">45</span>) <span class="co"># I think 45-degree month labels look nicer, but this is a matter of taste.</span></span>
<span id="cb17-8"><a></a>ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb17-9"><a></a></span>
<span id="cb17-10"><a></a><span class="co"># Manually changing our axis labels for more control</span></span>
<span id="cb17-11"><a></a>ax.set_xlabel(<span class="st">"Month"</span>,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">12</span>) </span>
<span id="cb17-12"><a></a>ax.set_ylabel(<span class="st">"City"</span>,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb17-13"><a></a></span>
<span id="cb17-14"><a></a><span class="co"># Set our title dynamically</span></span>
<span id="cb17-15"><a></a>ax.set_title(<span class="ss">f"Mean number of rainy days by month between </span><span class="sc">{</span>date_min<span class="sc">}</span><span class="ss"> and </span><span class="sc">{</span>date_max<span class="sc">}</span><span class="ss"> for Australia's top 5 cities"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>, pad<span class="op">=</span><span class="dv">15</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
</section>
<section id="a-fancy-multi-chart-visual" class="level3">
<h3>A fancy multi-chart visual</h3>
<p>This chart uses the <code>boxgrid</code> object to arrange multiple different subcharts. We’re actually generating two sets of different visuals (<code>linegrid</code> and <code>boxgrid</code>) in one output. If you’re not sure what the <code>for [...] in [...]</code> syntax means, don’t worry - this will be covered in a future session.</p>
<div id="78f7cff7" class="cell columns column-output-location" data-execution_count="60">
<div class="column">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a><span class="co"># Setting up the grid of box plots</span></span>
<span id="cb18-2"><a></a><span class="co"># Box plots are a bit of a rabbit hole and are extremely customisable; we're mostly using defaults here</span></span>
<span id="cb18-3"><a></a>boxgrid <span class="op">=</span> sns.FacetGrid(df_top5Cities </span>
<span id="cb18-4"><a></a>                        ,col<span class="op">=</span><span class="st">"Location"</span> <span class="co"># Defining the different facets</span></span>
<span id="cb18-5"><a></a>                        ,col_wrap<span class="op">=</span><span class="dv">5</span>, height<span class="op">=</span><span class="fl">4.5</span> <span class="co"># Layout and sizing for our facet grid</span></span>
<span id="cb18-6"><a></a>                        ,col_order<span class="op">=</span>colOrder_top5Cities  <span class="co"># Using our alphabetical order of city names to arrange our facets</span></span>
<span id="cb18-7"><a></a>)</span>
<span id="cb18-8"><a></a>boxgrid.<span class="bu">map</span>(sns.boxplot <span class="co"># This is what tells sns what sort of plots we want in our grid</span></span>
<span id="cb18-9"><a></a>            ,<span class="st">"Month"</span> <span class="co"># X</span></span>
<span id="cb18-10"><a></a>            ,<span class="st">"MaxTemp"</span> <span class="co"># Y</span></span>
<span id="cb18-11"><a></a>            ,linewidth<span class="op">=</span><span class="fl">1.5</span></span>
<span id="cb18-12"><a></a>            ,color<span class="op">=</span><span class="st">"skyblue"</span></span>
<span id="cb18-13"><a></a>            ,order<span class="op">=</span>month_order</span>
<span id="cb18-14"><a></a>            ,fliersize<span class="op">=</span><span class="dv">0</span> <span class="co"># Seaborn boxplots by default include markers for outliers, which it calls "fliers". For this chart we'd like to disable these.</span></span>
<span id="cb18-15"><a></a>            ) </span>
<span id="cb18-16"><a></a></span>
<span id="cb18-17"><a></a><span class="co"># Setting up the grid of line plots</span></span>
<span id="cb18-18"><a></a><span class="co"># Using the default matplotlib plot here</span></span>
<span id="cb18-19"><a></a>linegrid <span class="op">=</span> sns.FacetGrid(df_top5Cities.groupby([<span class="st">'Location'</span>, <span class="st">'Month'</span>])[<span class="st">'Rainfall'</span>].mean().reset_index()</span>
<span id="cb18-20"><a></a>                         ,col<span class="op">=</span><span class="st">"Location"</span> </span>
<span id="cb18-21"><a></a>                         ,hue<span class="op">=</span><span class="st">"Location"</span>,palette<span class="op">=</span><span class="st">"Set2"</span> </span>
<span id="cb18-22"><a></a>                         ,col_wrap<span class="op">=</span><span class="dv">5</span>, height<span class="op">=</span><span class="fl">4.5</span> </span>
<span id="cb18-23"><a></a>                         ,col_order<span class="op">=</span>colOrder_top5Cities</span>
<span id="cb18-24"><a></a>)</span>
<span id="cb18-25"><a></a>linegrid.<span class="bu">map</span>(plt.plot, <span class="st">"Month"</span>, <span class="st">"Rainfall"</span>,marker<span class="op">=</span><span class="st">"o"</span>)</span>
<span id="cb18-26"><a></a></span>
<span id="cb18-27"><a></a><span class="co"># Formatting axes</span></span>
<span id="cb18-28"><a></a><span class="cf">for</span> ax <span class="kw">in</span> boxgrid.axes.flat:</span>
<span id="cb18-29"><a></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">9</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-30"><a></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb18-31"><a></a><span class="cf">for</span> ax <span class="kw">in</span> linegrid.axes.flat:</span>
<span id="cb18-32"><a></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">9</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-33"><a></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb18-34"><a></a></span>
<span id="cb18-35"><a></a>linegrid.set_titles(col_template<span class="op">=</span><span class="st">"</span><span class="sc">{col_name}</span><span class="st">"</span>,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb18-36"><a></a>linegrid.set_axis_labels(<span class="st">"Month"</span>,<span class="st">"Average rainfall /mm"</span>,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-37"><a></a>boxgrid.set_titles(col_template<span class="op">=</span><span class="st">"</span><span class="sc">{col_name}</span><span class="st">"</span>,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb18-38"><a></a>boxgrid.set_axis_labels(<span class="st">"Month"</span>,<span class="st">"Max temp /$</span><span class="ch">\\</span><span class="st">degree$C"</span>,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb18-39"><a></a></span>
<span id="cb18-40"><a></a><span class="co"># Setting overall titles and spacing</span></span>
<span id="cb18-41"><a></a>linegrid.figure.suptitle(<span class="ss">f"Mean daily rainfall by month for top 5 cities, </span><span class="sc">{</span>date_range<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, color<span class="op">=</span><span class="st">'black'</span>,fontweight<span class="op">=</span><span class="st">'bold'</span>) </span>
<span id="cb18-42"><a></a>boxgrid.figure.suptitle(<span class="ss">f"Max temperature by month for top 5 cities, </span><span class="sc">{</span>date_range<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, color<span class="op">=</span><span class="st">'black'</span>,fontweight<span class="op">=</span><span class="st">'bold'</span>) </span>
<span id="cb18-43"><a></a>linegrid.figure.subplots_adjust(top<span class="op">=</span><span class="fl">0.85</span>)  </span>
<span id="cb18-44"><a></a>boxgrid.figure.subplots_adjust(top<span class="op">=</span><span class="fl">0.85</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-17-output-1.png"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-17-output-2.png"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="small-multiples-type-time-series-grid" class="level3">
<h3>“Small multiples”-type time-series grid</h3>
<p>This is mostly based on the example given at <a href="https://seaborn.pydata.org/examples/timeseries_facets.html" class="uri">https://seaborn.pydata.org/examples/timeseries_facets.html</a>.</p>
<p>Firstly, for this one we need another dataframe that just contains the Sydney data.</p>
<div id="b038daca" class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a>df_Sydney <span class="op">=</span> df[df[<span class="st">'Location'</span>]<span class="op">==</span><span class="st">"Sydney"</span>].groupby([<span class="st">'Month'</span>, <span class="st">'Location'</span>,<span class="st">'Year'</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">'MaxTemp'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div></div>
<p>We’re going to use the <code>relplot</code> function to create a grid of plots with a specific set of variables across its rows and columns. For each cell we’re plotting that year’s data with a different colour, and plotting all the other years in grey in the background.</p>
<div id="1e44712a" class="cell columns column-output-location" data-execution_count="61">
<div class="column">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a><span class="co"># plot each year's time series in its own facet</span></span>
<span id="cb20-2"><a></a>g <span class="op">=</span> sns.relplot(data<span class="op">=</span>df_Sydney</span>
<span id="cb20-3"><a></a>                ,x<span class="op">=</span><span class="st">"Month"</span></span>
<span id="cb20-4"><a></a>                ,y<span class="op">=</span><span class="st">"MaxTemp"</span></span>
<span id="cb20-5"><a></a>                ,col<span class="op">=</span><span class="st">"Year"</span></span>
<span id="cb20-6"><a></a>                ,hue<span class="op">=</span><span class="st">"Year"</span></span>
<span id="cb20-7"><a></a>                ,kind<span class="op">=</span><span class="st">"line"</span></span>
<span id="cb20-8"><a></a>                ,palette<span class="op">=</span><span class="st">"viridis"</span></span>
<span id="cb20-9"><a></a>                ,linewidth<span class="op">=</span><span class="dv">4</span></span>
<span id="cb20-10"><a></a>                ,zorder<span class="op">=</span><span class="dv">5</span></span>
<span id="cb20-11"><a></a>                ,col_wrap<span class="op">=</span><span class="dv">3</span>, height<span class="op">=</span><span class="dv">2</span>, aspect<span class="op">=</span><span class="fl">1.5</span>, legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-12"><a></a>)</span>
<span id="cb20-13"><a></a></span>
<span id="cb20-14"><a></a><span class="co"># iterate over each subplot to customize further</span></span>
<span id="cb20-15"><a></a><span class="cf">for</span> year, ax <span class="kw">in</span> g.axes_dict.items():</span>
<span id="cb20-16"><a></a></span>
<span id="cb20-17"><a></a>    <span class="co"># Add the title as an annotation within the plot</span></span>
<span id="cb20-18"><a></a>    ax.text(<span class="fl">.8</span></span>
<span id="cb20-19"><a></a>            ,<span class="fl">.85</span></span>
<span id="cb20-20"><a></a>            ,year</span>
<span id="cb20-21"><a></a>            ,transform<span class="op">=</span>ax.transAxes</span>
<span id="cb20-22"><a></a>            ,fontweight<span class="op">=</span><span class="st">"bold"</span>,fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb20-23"><a></a></span>
<span id="cb20-24"><a></a>    <span class="co"># Plot every year's time series in the background</span></span>
<span id="cb20-25"><a></a>    sns.lineplot(</span>
<span id="cb20-26"><a></a>        data<span class="op">=</span>df_Sydney, x<span class="op">=</span><span class="st">"Month"</span>, y<span class="op">=</span><span class="st">"MaxTemp"</span>, units<span class="op">=</span><span class="st">"Year"</span>,</span>
<span id="cb20-27"><a></a>        estimator<span class="op">=</span><span class="va">None</span>, color<span class="op">=</span><span class="st">".7"</span>, linewidth<span class="op">=</span><span class="dv">1</span>, ax<span class="op">=</span>ax</span>
<span id="cb20-28"><a></a>    )</span>
<span id="cb20-29"><a></a></span>
<span id="cb20-30"><a></a><span class="co"># reduce the frequency of the x axis ticks</span></span>
<span id="cb20-31"><a></a>ax.set_xticks(ax.get_xticks()[::<span class="dv">2</span>])</span>
<span id="cb20-32"><a></a></span>
<span id="cb20-33"><a></a><span class="co"># tweak the supporting aspects of the plot</span></span>
<span id="cb20-34"><a></a>g.set_titles(<span class="st">""</span>)</span>
<span id="cb20-35"><a></a>g.fig.suptitle(<span class="ss">f"Max temperature by month in Sydney, </span><span class="sc">{</span>date_range<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, color<span class="op">=</span><span class="st">'black'</span>,fontweight<span class="op">=</span><span class="st">'bold'</span>) </span>
<span id="cb20-36"><a></a>g.set_axis_labels(<span class="st">""</span>, <span class="st">"Max Temp /$</span><span class="ch">\\</span><span class="st">degree </span><span class="ch">\\</span><span class="st">mathrm</span><span class="sc">{C}</span><span class="st">$"</span>)<span class="op">;</span></span>
<span id="cb20-37"><a></a>g.tight_layout()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="session-04_files/figure-revealjs/cell-19-output-1.png"></p>
</figure>
</div>
</div>
</div></div>


</section>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/verticator/verticator.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":false},
'verticator': {"themetag":"h1","color":"","inversecolor":"","skipuncounted":false,"clickable":true,"position":"auto","offset":"3vmin","autogenerate":true,"tooltip":false,"scale":1},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, Verticator, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>